<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rock paper scissors</title>
</head>
<body>
  <h1>Rock, paper scisors</h1>
  <h3>Open the console to play</h3>   
    
  <script>
    function computerPlay(){
      let choice = Math.floor(Math.random()*3+1); //Random * (max-min+1)+min
      switch(choice){
        case 1:
          choice = "Rock";
          break;
        case 2:
          choice = "Paper";
          break;
        case 3:
          choice = "scissors";
          break;
        default:
          choice = "Invalid";
      }
      return(choice);
    }
    
    function playRound(playerSelection,computerSelection){
      playerSelection = playerSelection.toUpperCase()

      //Declaring the helper functions here for the sake of tidyness
      /*let PlayerWin = (playerSelection,computerSelection) =>{
        console.log(`You win! ${playerChoice.toLowerCase()} beats ${compChoice}`)
        return("playerWin")
      }*/
      switch(playerSelection)
      {
        case "ROCK":
          switch(computerSelection){
            case "Rock": 
              return("Draw");
            case "Paper":
              return("computerWin");
            case "scissors":
              return("playerWin");
          }
          break;

        case "PAPER":
          switch(computerSelection){
            case "Rock": 
              return("playerWin");
            case "Paper":
              return("Draw");
            case "scissors":
              return("computerWin");
          }
          break;

        case "SCISSORS":
          switch(computerSelection){
            case "Rock": 
              return("computerWin");
            case "Paper":
              return("playerWin");
            case "scissors":
              return("Draw");
          }
          break;

        default:
          console.log(`ERROR: player selection was: ${playerSelection}`)
          return("Unknown");
      }
    }

    function game(){
      let playerScore = 0;
      let computerScore = 0;

      for(let i =0; i<5; i++){
        //Getting and comparing the player and the computer choices
        let playerSelection = window.prompt("Please enter rock, paper or scissors"); //Replace the prompt with "Rock" to autoplay for debug purposes
        let computerSelection = computerPlay();
        let result = playRound(playerSelection,computerSelection)

        //Scoring
        if(result == "playerWin"){
          console.log(`Round ${(i+1)}: You win! ${playerSelection.toLowerCase()} beats ${computerSelection}`);
          playerScore++;
        }
        else if (result == "computerWin"){
          console.log(`Round ${(i+1)}: You lose! ${computerSelection} beats ${playerSelection.toLowerCase()}`);
          computerScore++;
        } 
        else if (result == "Draw"){
          console.log(`Round ${(i+1)}: Draw, you both chose ${computerSelection}`);
        }
        else{
          console.log(`ERROR: round ${(i+1)}, result: ${result}`);
        }
      }

      //find and declare the winner
      if(playerScore > computerScore){
        console.log(`Congratulations, you win! The final score was: ${playerScore} to ${computerScore}`);
      } 
      else if (playerScore < computerScore){
        console.log(`unfortunately you lost. The final score was: ${playerScore} to ${computerScore}`);

      } else{
        if(playerScore = 1){
          console.log(`The game was a draw, you both scored 1 point`);
        } else {
          console.log(`The game was a draw, you both scored ${playerScore} points`);
        }
      } 
    }
    game()
    </script>
</body>
</html>